{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Matias\\\\nexus-pro\\\\src\\\\pages\\\\ventas\\\\GestionVentas.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useContext } from 'react';\nimport { Eye, Trash2 } from 'lucide-react';\nimport { ContextoAuth } from '../../context/AuthContext';\nimport { Button, Modal, Table } from '../ui/ComponentesUI';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = 'http://127.0.0.1:8000/api';\nconst GestionVentas = ({\n  ventas,\n  obtenerDatos\n}) => {\n  _s();\n  const [ventaSeleccionada, setVentaSeleccionada] = useState(null);\n  const {\n    tokensAuth\n  } = useContext(ContextoAuth);\n  const cancelarVenta = async idVenta => {\n    if (window.confirm(\"¿Estás seguro de que quieres cancelar esta venta? El stock de los productos será restaurado.\")) {\n      try {\n        const response = await fetch(`${API_URL}/sales/${idVenta}/`, {\n          method: 'DELETE',\n          headers: {\n            'Authorization': 'Bearer ' + String(tokensAuth.access)\n          }\n        });\n        if (!response.ok) {\n          throw new Error(\"No se pudo cancelar la venta.\");\n        }\n        alert('Venta cancelada con éxito.');\n        obtenerDatos();\n      } catch (err) {\n        alert(`Error: ${err.message}`);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-bold text-gray-800\",\n      children: \"Historial de Ventas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      headers: ['ID', 'Fecha', 'Usuario', 'Items', 'Subtotal', 'Total Final', 'Acciones'],\n      data: ventas,\n      renderRow: venta => /*#__PURE__*/_jsxDEV(\"tr\", {\n        className: \"bg-white border-b hover:bg-gray-50\",\n        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n          className: \"px-6 py-4\",\n          children: [\"#\", venta.id]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          className: \"px-6 py-4\",\n          children: new Date(venta.date_time).toLocaleString('es-AR')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          className: \"px-6 py-4\",\n          children: venta.user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 40,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          className: \"px-6 py-4\",\n          children: venta.details.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          className: \"px-6 py-4\",\n          children: [\"$\", parseFloat(venta.total_amount).toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          className: \"px-6 py-4 font-bold\",\n          children: [\"$\", parseFloat(venta.final_amount).toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          className: \"px-6 py-4 flex gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => setVentaSeleccionada(venta),\n            variant: \"secondary\",\n            icon: Eye\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => cancelarVenta(venta.id),\n            variant: \"danger\",\n            icon: Trash2\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 46,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 25\n        }, this)]\n      }, venta.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 13\n    }, this), ventaSeleccionada && /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: !!ventaSeleccionada,\n      onClose: () => setVentaSeleccionada(null),\n      title: `Detalle de Venta #${ventaSeleccionada.id}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"space-y-2\",\n          children: ventaSeleccionada.details.map(detalle => /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"flex justify-between items-center p-2 bg-gray-50 rounded-md\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [detalle.quantity, \" x \", detalle.product.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 57,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"$\", (detalle.quantity * parseFloat(detalle.unit_price)).toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 58,\n              columnNumber: 37\n            }, this)]\n          }, detalle.product.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4 pt-2 border-t text-right\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Subtotal: $\", parseFloat(ventaSeleccionada.total_amount).toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"M\\xE9todo de Pago: \", ventaSeleccionada.payment_method]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"font-bold text-lg\",\n            children: [\"Total Final: $\", parseFloat(ventaSeleccionada.final_amount).toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 9\n  }, this);\n};\n_s(GestionVentas, \"LiTtQRsMa9lQntTp8O0kfDfQe40=\");\n_c = GestionVentas;\nexport default GestionVentas;\nvar _c;\n$RefreshReg$(_c, \"GestionVentas\");","map":{"version":3,"names":["React","useState","useContext","Eye","Trash2","ContextoAuth","Button","Modal","Table","jsxDEV","_jsxDEV","API_URL","GestionVentas","ventas","obtenerDatos","_s","ventaSeleccionada","setVentaSeleccionada","tokensAuth","cancelarVenta","idVenta","window","confirm","response","fetch","method","headers","String","access","ok","Error","alert","err","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","data","renderRow","venta","id","Date","date_time","toLocaleString","user","details","length","parseFloat","total_amount","toFixed","final_amount","onClick","variant","icon","isOpen","onClose","title","map","detalle","quantity","product","name","unit_price","payment_method","_c","$RefreshReg$"],"sources":["C:/Users/Matias/nexus-pro/src/pages/ventas/GestionVentas.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { Eye, Trash2 } from 'lucide-react';\r\nimport { ContextoAuth } from '../../context/AuthContext';\r\nimport { Button, Modal, Table } from '../ui/ComponentesUI';\r\n\r\nconst API_URL = 'http://127.0.0.1:8000/api';\r\n\r\nconst GestionVentas = ({ ventas, obtenerDatos }) => {\r\n    const [ventaSeleccionada, setVentaSeleccionada] = useState(null);\r\n    const { tokensAuth } = useContext(ContextoAuth);\r\n\r\n    const cancelarVenta = async (idVenta) => {\r\n        if (window.confirm(\"¿Estás seguro de que quieres cancelar esta venta? El stock de los productos será restaurado.\")) {\r\n            try {\r\n                const response = await fetch(`${API_URL}/sales/${idVenta}/`, {\r\n                    method: 'DELETE',\r\n                    headers: { 'Authorization': 'Bearer ' + String(tokensAuth.access) }\r\n                });\r\n                if (!response.ok) {\r\n                    throw new Error(\"No se pudo cancelar la venta.\");\r\n                }\r\n                alert('Venta cancelada con éxito.');\r\n                obtenerDatos();\r\n            } catch (err) {\r\n                alert(`Error: ${err.message}`);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <h1 className=\"text-3xl font-bold text-gray-800\">Historial de Ventas</h1>\r\n            <Table\r\n                headers={['ID', 'Fecha', 'Usuario', 'Items', 'Subtotal', 'Total Final', 'Acciones']}\r\n                data={ventas}\r\n                renderRow={(venta) => (\r\n                    <tr key={venta.id} className=\"bg-white border-b hover:bg-gray-50\">\r\n                        <td className=\"px-6 py-4\">#{venta.id}</td>\r\n                        <td className=\"px-6 py-4\">{new Date(venta.date_time).toLocaleString('es-AR')}</td>\r\n                        <td className=\"px-6 py-4\">{venta.user}</td>\r\n                        <td className=\"px-6 py-4\">{venta.details.length}</td>\r\n                        <td className=\"px-6 py-4\">${parseFloat(venta.total_amount).toFixed(2)}</td>\r\n                        <td className=\"px-6 py-4 font-bold\">${parseFloat(venta.final_amount).toFixed(2)}</td>\r\n                        <td className=\"px-6 py-4 flex gap-2\">\r\n                            <Button onClick={() => setVentaSeleccionada(venta)} variant=\"secondary\" icon={Eye} />\r\n                            <Button onClick={() => cancelarVenta(venta.id)} variant=\"danger\" icon={Trash2} />\r\n                        </td>\r\n                    </tr>\r\n                )}\r\n            />\r\n            {ventaSeleccionada && (\r\n                <Modal isOpen={!!ventaSeleccionada} onClose={() => setVentaSeleccionada(null)} title={`Detalle de Venta #${ventaSeleccionada.id}`}>\r\n                    <div>\r\n                        <ul className=\"space-y-2\">\r\n                            {ventaSeleccionada.details.map(detalle => (\r\n                                <li key={detalle.product.id} className=\"flex justify-between items-center p-2 bg-gray-50 rounded-md\">\r\n                                    <span>{detalle.quantity} x {detalle.product.name}</span>\r\n                                    <span>${(detalle.quantity * parseFloat(detalle.unit_price)).toFixed(2)}</span>\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                        <div className=\"mt-4 pt-2 border-t text-right\">\r\n                            <p>Subtotal: ${parseFloat(ventaSeleccionada.total_amount).toFixed(2)}</p>\r\n                            <p>Método de Pago: {ventaSeleccionada.payment_method}</p>\r\n                            <p className=\"font-bold text-lg\">Total Final: ${parseFloat(ventaSeleccionada.final_amount).toFixed(2)}</p>\r\n                        </div>\r\n                    </div>\r\n                </Modal>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default GestionVentas;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}